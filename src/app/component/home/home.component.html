<main class="full-screen-container compensate-nav" ngClass.lt-sm="no-padding" fxLayoutGap="2rem" fxLayout="column">
  <div fxFlex="grow">
    <!-- filter tab -->
    <mat-tab-group headerPosition="below" dynamicHeight="true" mat-stretch-tabs class="h-100">
      <mat-tab style="height: 100%">
        <ng-template mat-tab-label>
          <mat-icon>search</mat-icon>
        </ng-template>
        <div class="mat-tab-content">
          <form [formGroup]="placeSearchForm" 
                fxLayout="row wrap"
                fxLayoutGap="5px"
                fxLayoutAlign="start center">
            <mat-form-field appearance="outline">
              <mat-label>Longitude</mat-label>
              <input matInput type="number" formControlName="long">
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Latitude</mat-label>
              <input matInput type="number" formControlName="lat">
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Radius (meters)</mat-label>
              <input matInput type="number" formControlName="radius">
            </mat-form-field>

            <button fxFlex="nogrow" mat-raised-button color="primary" (click)="findPlaces()">Search</button>
            <button mat-raised-button color="primary" (click)="useCurrentLocation()">Use Current Location</button>
            
            <mat-divider></mat-divider>
          </form>
        </div>
      </mat-tab>

      <!-- map tab -->
      <mat-tab>
        <ng-template mat-tab-label>
          <mat-icon>place</mat-icon>
        </ng-template>
        <div class="mat-tab-content">
          <agm-map class="h-100" [zoom]="15" [latitude]="lat" [longitude]="long">
            <agm-marker [latitude]="lat" [longitude]="long"></agm-marker>
            <agm-marker *ngFor="let place of places | async"
              [latitude]="place.lat" 
              [longitude]="place.long">
            </agm-marker>
            <agm-marker *ngFor="let place of places | async"
              [latitude]="place.geometry.location.lat" 
              [longitude]="place.geometry.location.lng">
            </agm-marker>
          </agm-map>
        </div>
      </mat-tab>

      <!-- list view tab -->
      <mat-tab>
        <ng-template mat-tab-label>
          <mat-icon>list</mat-icon>
        </ng-template>
        <div class="mat-tab-content">
          <div style="overflow: scroll" fxLayout="column" fxLayoutGap="1rem">
            <mat-card *ngFor="let place of places | async" style="width: 100%; margin: 1rem;">
              <mat-card-header [ngStyle]="{ 'background-image': 'url(' + place.image + ')'}">
              </mat-card-header>
              <mat-card-content>
                <mat-card-title>{{place.name}}</mat-card-title>
                <mat-chip-list>
                  <mat-chip color="accent" selected *ngFor="let type of place.types">{{type}}</mat-chip>
                </mat-chip-list>
              </mat-card-content>
              <mat-card-actions>
                <button mat-button (click)="savePlace(place.place_id)">SAVE</button>
              </mat-card-actions>
            </mat-card>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</main>